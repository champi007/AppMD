<md-dialog  md-theme="temaDESCO">
  <form name="agregarAccesorioForm">
    <md-toolbar>
      <div class="md-toolbar-tools">
        <h2 ng-if="!editandoAccesorio">Agregar Accesorios</h2>
        <h2 ng-if="editandoAccesorio">Editar Accesorios</h2>
        <span flex></span>
        <md-button class="md-icon-button" ng-click="cerrarDialog()">
          <md-icon>close</md-icon>
        </md-button>
      </div>
    </md-toolbar>
    <md-dialog-content layout-padding>
      <md-content layout-padding layout-wrap>
          <div>
            <md-subheader class="md-no-sticky">
              <div layout="row" layout-align="start start">
                <div ng-if="!editandoAccesorio">
                  Por favor llena los siguientes campos, solo elegir el accesorio y la cantidad es obligatorio.
                </div>
                <div ng-if="editandoAccesorio">
                  Por favor llena los siguientes campos, solo elegir el accesorio y la cantidad es obligatorio.
                </div>
              </div>
            </md-subheader>
              <div ng-if="!editandoAccesorio" layout="row" style="padding:10px" layout-align="start center"  class="md-3-line">
                    <md-input-container flex="35">
                      <label>Accesorio</label>
                      <md-select required name="accesorio" md-on-open="cargarAccesorios()" ng-model="accesorioElegidoModel.accesorioObject">
                        <md-select-header style="height:60px; padding-right:15px" layout="row" layout-align="start center">
                          <md-icon flex-offset="5" style="margin-top:30px" flex="10">search</md-icon>
                          <md-input-container style="margin-top:60px" flex-offset="5" flex>
                            <label>Buscar Accesorio</label>
                            <input id="accesorioBusqueda" type="search" ng-model="busqueda">
                          </md-input-container>
                        </md-select-header>
                        <md-option ng-value="accesorio" ng-repeat="accesorio in accesorios | filter:busqueda">{{accesorio.nombre}}</md-option>
                      </md-select>
                      <div ng-messages="agregarAccesorioForm.accesorio.$error">
                        <div ng-message="required">
                          Seleccionar un accesorio es requerido.
                        </div>
                      </div>
                    </md-input-container>
                    <md-input-container  style="margin-bottom:-5px">
                      <label>Cantidad</label>
                      <input ng-disabled="!accesorioElegidoModel.accesorioObject" type="number" min="1" name="cantidad" ng-model="accesorioElegidoModel.cantidad" required>
                      <div ng-messages="agregarAccesorioForm.cantidad.$error">
                          <div ng-message="required">
                              La cantidad del accesorio elegido es requerida.
                          </div>
                      </div>
                    </md-input-container>
                    <md-input-container  style="margin-top:40px">
                      <label>Costo</label>
                      <input type="number" min="0" ng-model="accesorioElegidoModel.costo">
                    </md-input-container>
                    <div>
                      <md-button ng-disabled="agregarAccesorioForm.$invalid" ng-click="agregarAccesorioElegidoAElegidos(agregarAccesorioForm)" flex-offset="5" class="md-icon-button">
                        <md-tooltip md-direction="top">
                          Añadir
                        </md-tooltip>
                        <md-icon>add</md-icon>
                      </md-button>
                    </div>
              </div>
              <div ng-if="editandoAccesorio" layout="row" style="padding:10px" layout-align="start center"  class="md-3-line">
                    <p flex="20" class="md-body-2">{{accesorioEditado.accesorioObject.nombre}}</p>
                    <md-input-container  style="margin-bottom:-5px">
                      <label>Cantidad</label>
                      <input ng-disabled="!accesorioEditado.accesorioObject" type="number" min="1" name="cantidad" ng-model="accesorioEditado.cantidad" required>
                      <div ng-messages="agregarAccesorioForm.cantidad.$error">
                          <div ng-message="required">
                              La cantidad del accesorio elegido es requerida.
                          </div>
                      </div>
                    </md-input-container>
                    <md-input-container  style="margin-top:40px">
                      <label>Costo</label>
                      <input type="number" min="0" ng-model="accesorioEditado.costo">
                    </md-input-container>
                    <div>
                      <md-button ng-disabled="agregarAccesorioForm.$invalid" ng-click="terminarEdicion()" flex-offset="5" class="md-icon-button">
                        <md-tooltip md-direction="top">
                          Guardar
                        </md-tooltip>
                        <md-icon>done</md-icon>
                      </md-button>
                  </div>
                  <div>
                  <md-button  ng-click="cancelarEdicion()" flex-offset="5" class="md-icon-button">
                      <md-tooltip md-direction="top">
                        Cancelar
                      </md-tooltip>
                      <md-icon>clear</md-icon>
                    </md-button>
                </div>
              </div>
          </div>
      </md-content>
      <md-divider></md-divider>
      <md-content ng-if="accesoriosElegidos.length > 0" layout-padding layout-wrap>
        <md-list>
          <div layout="row"  layout-align="space-between start" ng-repeat="accesorioElegido in accesoriosElegidos">
            <md-divider></md-divider>
            <div flex="20" layout="column">
              <div class="md-subheader">
                Descripción
              </div>
              <p class="md-body-1">{{accesorioElegido.accesorioObject.nombre}}</p>
            </div>
            <div flex-offset="5" layout="column">
              <div class="md-subheader">
                Cantidad
              </div>
              <p class="md-body-1">{{accesorioElegido.cantidad}}</p>
            </div>
            <div flex-offset="5" layout="column">
              <div class="md-subheader">
                Costo
              </div>
              <p ng-if="accesorioElegido.costo" class="md-body-1">{{accesorioElegido.costo | currency}}</p>
              <p ng-if="!accesorioElegido.costo" class="md-body-1">No se especificó</p>
            </div>
            <div flex-offset="5" layout="column">
              <div style="opacity:0" class="md-subheader">
                Préstamo
              </div>
              <md-button ng-disabled="editandoAccesorio" ng-click="editarAccesorio(accesorioElegido)" class="md-icon-button">
                <md-tooltip md-direction="top">
                  Editar
                </md-tooltip>
                <md-icon>edit</md-icon>
              </md-button>
            </div>
            <div  layout="column">
              <div style="opacity:0" class="md-subheader">
                Préstamo
              </div>
              <md-button ng-click="eliminarAccesorioDeElegidos($index)" class="md-icon-button">
                <md-tooltip md-direction="top">
                  Eliminar
                </md-tooltip>
                <md-icon>delete</md-icon>
              </md-button>
            </div>
          </div>
          <md-divider></md-divider>
        </md-list>
      </md-content>
    </md-dialog-content>
    <md-dialog-actions layout="row">
      <md-button ng-click="cerrarDialog()">Cancelar</md-button>
      <md-button ng-disabled="accesoriosElegidos.length == 0 || editandoAccesorio" ng-click="agregarAccesoriosElegidosAOrden()">Agregar Accesorios</md-button>
    </md-dialog-actions>
  </form>
</md-dialog>
